<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="kr.co.loyd.dao.ReviewsDao">


	<!-- 구매 후기 보기 -->
	<select id="one" parameterType="int" resultType="kr.co.loyd.dto.ReviewsDto">
		select * from reviews where Review_id = #{id}
	</select>

	<!-- 구매 후기 작성 -->

	<insert id = "writeOk1" parameterType="kr.co.loyd.dto.ReviewWriteDto">
		insert into reviews(member_id, watch_id, content, writeday, rate)
		values(#{member_id},#{watch_id},#{content}, now(),#{rate})
	
	</insert>
	
		<insert id = "writeOk2" parameterType="kr.co.loyd.dto.AddfileDto">
		insert into add_file (id, name, path, size)
		values(#{id},#{name},#{path},#{size})
	
	</insert>
	

	
	
	<select id="list" resultType="kr.co.loyd.dto.ReviewsDto">
		select * from reviews r 
		LEFT JOIN add_file af
		ON r.file_id = af.id
		order by review_id DESC
		limit #{param1}, 9
		 
	</select>
	
	<update id="readnum"> <!-- result, parameter -->
		update reviews set view=view+1 where review_id=#{param1}
	</update>
	
	<select id="get_pagecount" resultType="Integer">
		select ceil (count(*)/5) from reviews
	</select>
	
	
	
	<!-- 대시보드 목록 조회 -->
	<select id="dash_listr" resultType="kr.co.loyd.dto.ReviewsDto">
		select content,writeday from reviews order by writeday desc limit 0,5
	</select>
	
	
	
	

	<!-- 조건 + 페이징 -->

</mapper>


